\documentclass[11pt, a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{geometry}
\geometry{left=1in, right=1in, top=1in, bottom=1in}
\usepackage{titlesec}
\usepackage{enumitem}
\usepackage{hyperref}
\usepackage{xcolor}
\usepackage{lmodern}
\usepackage{amssymb}
\usepackage{tabularx}
\usepackage{multicol}
\usepackage{array}
\usepackage{setspace}

% Colors
\definecolor{sectiongray}{RGB}{240,240,240}
\definecolor{graytext}{RGB}{100,100,100}

% Section bar
\newcommand{\sectionbar}[1]{%
  \vspace{1.5ex}
  \noindent\colorbox{sectiongray}{\parbox{\dimexpr\linewidth-2\fboxsep}{\centering\textbf{\MakeUppercase{#1}}}}\\[0.5ex]
}

% Dotted leader for skills
\newcommand{\skillrow}[2]{%
  \noindent#1 \dotfill \textit{#2}\\
}

\pagestyle{empty}

\begin{document}

% Header
\begin{center}
    {\LARGE \bfseries <%= profile.name || 'NAME' %>}\\[2pt]
    {\large \textit{<%= profile.jobTitle || 'JOB TITLE' %>}}\\[4pt]
    <%= profile.contactInfo.address || 'ADDRESS' %>\\[2pt]
    {\bfseries (<%= profile.contactInfo.phone || 'PHONE' %>)} \hfill \href{mailto:<%= profile.contactInfo.email || 'EMAIL' %>}{<%= profile.contactInfo.email || 'EMAIL' %>}
\end{center}

% Profile
<% if (profile.careerObjective && profile.careerObjective.trim()) { %>
\sectionbar{Profile}
\noindent\begin{minipage}{\linewidth}
\centering
<%= profile.careerObjective %>
\end{minipage}
<% } %>

% Employment History
<% if (profile.jobHistory && profile.jobHistory.length > 0) { %>
\vspace{1ex}
\sectionbar{Employment History}
\vspace{0.5ex}
<% profile.jobHistory.forEach(function(job) { %>
  \noindent{\bfseries $\blacklozenge$ <%= job.title || 'TITLE' %>, <%= job.company || 'COMPANY' %>}
  \hfill {\color{graytext}\textit{<%= job.startDate || 'START' %> --- <%= job.endDate || 'END' %>}}\\
  <% if (job.location) { %>
    \hspace*{1.5em}{\small <%= job.location %>}\\
  <% } %>
  <% if (job.accomplishments && job.accomplishments.length > 0) { %>
    \begin{itemize}[leftmargin=2em, itemsep=0pt, parsep=0pt]
    <% job.accomplishments.forEach(function(accomplishment) { %>
      \item <%= accomplishment %>
    <% }); %>
    \end{itemize}
  <% } %>
  \vspace{0.5ex}
<% }); %>
<% } %>

% Education
<% if (profile.education && profile.education.length > 0) { %>
\sectionbar{Education}
<% profile.education.forEach(function(edu) { %>
  \noindent{\bfseries $\blacklozenge$ <%= edu.school || 'SCHOOL' %>} \hfill {\color{graytext}\textit{<%= edu.dates || 'DATES' %>}}\\
  {\emph{<%= edu.degree || 'DEGREE' %>}}\\[1ex]
<% }); %>
<% } %>

% Skills
<% if (profile.skills && profile.skills.length > 0) { %>
\sectionbar{Skills}
\vspace{0.5ex}
\begin{tabularx}{\linewidth}{@{}X X X@{}}
<% for (let i = 0; i < profile.skills.length; i += 3) { %>
  <% for (let j = 0; j < 3; j++) { %>
    <% if (profile.skills[i+j]) { %>
      <%= profile.skills[i+j] %> \dotfill \textit{Expert}
      <% if (j < 2) { %> & <% } %>
    <% } else { %>
      <% if (j < 2) { %> & <% } %>
    <% } %>
  <% } %> \\
<% } %>
\end{tabularx}
<% } %>

% Internships
<% if (profile.internships && profile.internships.length > 0) { %>
\sectionbar{Internships}
<% profile.internships.forEach(function(internship) { %>
  \noindent{\bfseries $\blacklozenge$ <%= internship.title || 'TITLE' %>, <%= internship.company || 'COMPANY' %>}
  \hfill {\color{graytext}\textit{<%= internship.startDate || 'START' %> --- <%= internship.endDate || 'END' %>}}\\
  <% if (internship.location) { %>
    \hspace*{1.5em}{\small <%= internship.location %>}\\
  <% } %>
  <% if (internship.accomplishments && internship.accomplishments.length > 0) { %>
    \begin{itemize}[leftmargin=2em, itemsep=0pt, parsep=0pt]
    <% internship.accomplishments.forEach(function(accomplishment) { %>
      \item <%= accomplishment %>
    <% }); %>
    \end{itemize}
  <% } %>
  \vspace{0.5ex}
<% }); %>
<% } %>

% References
\sectionbar{References}
\noindent Available upon request

\end{document}
